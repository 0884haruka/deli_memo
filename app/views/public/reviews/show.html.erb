<p id="notice"></p>
<div class="container">
  <div class="row">
    <div class="col-md-12">
      <h2 class="mt-3">review details</h2>
    </div>
    <div class="col-md-4">
      <%= image_tag @review.review_image.variant(resize:'300x300') if @review.review_image.attached? %>
    </div>
    <div class="col-md-8"></div>
      <table class="table t-bordered">
      <!--<table class="table table-hover">どちらにしようか考え中-->
        <tr>
          <td>投稿者</td>
          <td>
            <!--投稿者のページへ遷移させたい-->
            <%=link_to mypage_path(@review.member.id) do %>
              <%= image_tag @review.member.get_profile_image(100,100) %><br />
              <%= @review.member.nick_name %>
            <% end %>
          </td>
        </tr>
        <tr>
          <td>商品名</td>
          <td><%= @review.title %></td>
        </tr>
        <tr>
          <td>レビュー内容</td>
          <td><%= @review.body %></td>
        </tr>
        <tr>
          <td>お値段（税込）</td>
          <td><%= @review.price%>円</td>
        </tr>
        <tr>
          <td>地域</td>
          <td><%= @review.prefecture %></td>
        </tr>
        <tr>
          <td>食品カテゴリー</td>
          <td><%= @review.food_category%></td>
        </tr>
        <tr>
          <td>掲載の有無</td>
          <td>
            <% if @review.is_active == true %>
              掲載
            <% end %>
            <% if @review.is_active == false %>
              未掲載
            <% end %>
          </td>
        </tr>
        <tr>
          <td>
            <div>
              <p>コメント件数：<%= @review.comments.count %></p>
              <% @review.comments.each do |comment| %>
                <p><%= image_tag comment.member.get_profile_image(100,100) %></p>
                <%= comment.member.name %>
                <%= comment.created_at.strftime('%Y/%m/%d') %><%= comment.comment %>
                <% if comment.member == current_member %>
                  <%= link_to "削除", review_comment_path(comment.review, comment), method: :delete %>
                <% end %>
              <% end %>
            </div>
            <div>
              <%= form_with model: [@review, @comment] do |f| %>
                <%= f.text_area :comment, rows: '5', placeholder: "コメントをここに" %>
                <%= f.submit "送信する" %>
              <% end %>
            </div>
          </td>
          <td>
            <% if @review.liked_by?(current_member) %>
            <p>
              <%= link_to review_likes_path(@review), method: :delete do %>
                ♥<%= @review.likes.count %> いいね
              <% end %>
            </p>
            <% else %>
            <p>
              <%= link_to review_likes_path(@review), method: :post do %>
                ♡<%= @review.likes.count %> いいね
              <% end %>
            </p>
          <% end %>
          </td>
        </tr>

      </table>
    </div>
    <% if @member == current_member %>
    <div class = "text-center">
      <%= link_to "編集する", edit_review_path, class: "btn btn-outline-danger col-6" %>
    </div>
    <div class = "text-center mt-3">
      <%= link_to "削除する", review_path(@review), method: :delete, class: "btn btn-outline-secondary col-6" %>
    </div>
    <% end %>
  </div>
</div>
